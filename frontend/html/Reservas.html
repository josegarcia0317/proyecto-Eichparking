<!--
=========================================================
* * Black Dashboard - v1.0.1
=========================================================

* Product Page: https://www.creative-tim.com/product/black-dashboard
* Copyright 2019 Creative Tim (https://www.creative-tim.com)


* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="../assets/img/favicon.png">
  <title>
    Reservas De clientes Frecuentes
  </title>
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,600,700,800" rel="stylesheet" />
  <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
  <!-- Nucleo Icons -->
  <link href="../assets/css/nucleo-icons.css" rel="stylesheet" />
  <!-- CSS Files -->
  <link href="../assets/css/black-dashboard.css?v=1.0.0" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-rtl/3.4.0/css/bootstrap-rtl.css" rel="stylesheet" />
  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link href="../assets/demo/demo.css" rel="stylesheet" />
</head>
<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="../assets/img/favicon.png">
  <title>Reservas Clientes Frecuentes</title>
  <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,600,700,800" rel="stylesheet" />
  <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
  <link href="../assets/css/nucleo-icons.css" rel="stylesheet" />
  <link href="../assets/css/black-dashboard.css?v=1.0.0" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-rtl/3.4.0/css/bootstrap-rtl.css" rel="stylesheet" />
  <link href="../assets/demo/demo.css" rel="stylesheet" />
  <style>
    .login-center {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
  </style>
</head>

<body class="">
  <div class="container login-center">
    <div class="card" style="max-width:400px; width:100%;">
      <div class="card-header text-center">
        <h4>Iniciar Sesión</h4>
      </div>
      <div class="card-body">
        <form id="loginForm">
          <div class="form-group">
            <label>Correo</label>
            <input type="email" id="email" class="form-control" required>
          </div>
          <div class="form-group">
            <label>Contraseña</label>
            <input type="password" id="password" class="form-control" required>
          </div>
          <button type="submit" class="btn btn-primary btn-block">Ingresar</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Tarjeta de reservas -->
  <div class="container" id="reserveCard" style="display:none; margin-top:40px;">
    <div class="card">
      <div class="card-header">
        <h4 id="welcome"></h4>
      </div>
      <div class="card-body">
        <form id="reserveForm">
          <div class="form-group">
            <label>Fecha</label>
            <input type="date" id="date" class="form-control" required>
          </div>
          <div class="form-group">
            <label>Hora de inicio</label>
            <input type="time" id="startTime" class="form-control" required>
          </div>
          <div class="form-group">
            <label>Hora de fin</label>
            <input type="time" id="endTime" class="form-control" required>
          </div>
          <div class="form-group">
            <label>Espacio</label>
            <select id="space" class="form-control" required>
              <option value="A1">A1</option>
              <option value="A2">A2</option>
              <option value="B1">B1</option>
              <option value="B2">B2</option>
            </select>
          </div>
          <button type="submit" class="btn btn-success btn-block">Reservar</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Historial -->
  <div class="container" id="historyRow" style="display:none; margin-top:20px;">
    <div class="card">
      <div class="card-header">
        <h4>Historial de Reservas</h4>
      </div>
      <div class="card-body" id="historyList"></div>
    </div>
  </div>

  <script>
    const loginForm = document.getElementById('loginForm');
    const reserveCard = document.getElementById('reserveCard');
    const loginCard = document.querySelector('.login-center');
    const historyRow = document.getElementById('historyRow');
    const welcome = document.getElementById('welcome');
    const reserveForm = document.getElementById('reserveForm');
    const historyList = document.getElementById('historyList');

    // Iniciar sesión con cualquier correo y contraseña
    loginForm.addEventListener('submit', e => {
      e.preventDefault();
      const email = document.getElementById('email').value.trim();
      const pass = document.getElementById('password').value.trim();

      if (!email || !pass) {
        alert('Debes ingresar correo y contraseña');
        return;
      }

      const user = { email, name: email.split('@')[0] };
      sessionStorage.setItem('user', JSON.stringify(user));

      loginCard.style.display = 'none';
      reserveCard.style.display = 'block';
      historyRow.style.display = 'block';
      welcome.textContent = `Hola, ${user.name} (Cliente frecuente)`;
      renderHistory();
    });

    // Guardar reserva
    reserveForm.addEventListener('submit', e => {
      e.preventDefault();
      const date = document.getElementById('date').value;
      const start = document.getElementById('startTime').value;
      const end = document.getElementById('endTime').value;
      const space = document.getElementById('space').value;
      const user = JSON.parse(sessionStorage.getItem('user'));

      let reservas = JSON.parse(localStorage.getItem('reservas') || '[]');
      reservas.push({ user: user.email, date, start, end, space });
      localStorage.setItem('reservas', JSON.stringify(reservas));

      alert('Reserva guardada');
      renderHistory();
      reserveForm.reset();
    });

    function renderHistory() {
      const user = JSON.parse(sessionStorage.getItem('user'));
      let reservas = JSON.parse(localStorage.getItem('reservas') || '[]');
      reservas = reservas.filter(r => r.user === user.email);
      historyList.innerHTML = reservas.length
        ? `<ul>${reservas.map(r => `<li>${r.date} ${r.start}-${r.end} | Espacio: ${r.space}</li>`).join('')}</ul>`
        : '<p>No tienes reservas.</p>';
    }
  </script>
</body>
</html>
